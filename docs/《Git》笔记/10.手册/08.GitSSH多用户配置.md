---
title: Git SSH å¤šç”¨æˆ·é…ç½®
date: 2022-04-26 16:24:50
permalink: /pages/183a99/
categories:
  - åŸºæœ¬æŠ€èƒ½
tags:
  - Git
  - å¿…å¤‡æŠ€èƒ½
---

# Git SSH å¤šç”¨æˆ·é…ç½®

## ğŸ“–. å‰è¨€

å½“æˆ‘ä»¬ä½¿ç”¨ Git æ—¶ï¼Œå¸¸ç”¨çš„æˆæƒé€šå¸¸æœ‰ä¸¤ç§æ–¹å¼ï¼šHTTPS å’Œ SSHã€‚å½“é€‰ç”¨ HTTPS æ—¶ï¼Œæ¯æ¬¡ä»£ç çš„å¢åˆ æ”¹æŸ¥éƒ½éœ€è¦è¾“å…¥ä¸€ä¸²å¯†ç è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå½±å“ä»£ç æäº¤æ•ˆç‡ï¼Œå› æ­¤å¤§éƒ¨åˆ†æƒ…å†µä¸‹æˆ‘ä»¬ä¼šä½¿ç”¨ SSH å…å¯†ç™»å½•ã€‚
é‚£ä¹ˆï¼Œåœ¨ä½¿ç”¨ SSH å…å¯†ç™»å½•è¿‡ç¨‹ä¸­ï¼Œä½ æœ‰é‡åˆ°è¿‡ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ

å¾ˆå¤šæœ‹å‹åœ¨ç”¨ github ç®¡ç†é¡¹ç›®çš„æ—¶å€™ï¼Œéƒ½æ˜¯ç›´æ¥ä½¿ç”¨ https url å…‹éš†åˆ°æœ¬åœ°ï¼Œå½“ç„¶ä¹Ÿæœ‰æœ‰äº›äººä½¿ç”¨ SSH url å…‹éš†åˆ°æœ¬åœ°ã€‚ç„¶è€Œï¼Œä¸ºä»€ä¹ˆç»å¤§å¤šæ•°äººä¼šä½¿ç”¨https urlå…‹éš†å‘¢ï¼Ÿ

è¿™æ˜¯å› ä¸ºï¼Œä½¿ç”¨ https url å…‹éš†å¯¹åˆå­¦è€…æ¥è¯´ä¼šæ¯”è¾ƒæ–¹ä¾¿ï¼Œå¤åˆ¶ https url ç„¶ååˆ° `git Bash` é‡Œé¢ç›´æ¥ç”¨ `clone` å‘½ä»¤å…‹éš†åˆ°æœ¬åœ°å°±å¥½äº†ã€‚è€Œä½¿ç”¨ SSH url å…‹éš†å´éœ€è¦åœ¨å…‹éš†ä¹‹å‰å…ˆé…ç½®å’Œæ·»åŠ å¥½ SSH key ã€‚

å¯æ˜¯å¯¹äºå¾ˆå¤šå°ä¼™ä¼´æ¥è¯´ï¼ŒGit è´¦æˆ·åŸºæœ¬éƒ½ä¸ä»…ä»…ä¸€ä¸ªï¼Œä¸å•å•æ˜¯å…¬å¸çš„ Gitlabã€Gitee ç­‰å…¶ä»–ä»£ç æ‰˜ç®¡å¹³å°çš„è´¦æˆ·ï¼Œä¹Ÿä¼šæœ‰è‡ªå·±ä¸ªäººçš„ GitHub è´¦æˆ·æ•´ç†è‡ªå·±çš„å­¦ä¹ ä»£ç ï¼Œé‚£å¦‚ä½•åœ¨åŒä¸€å°ç”µè„‘ä¸Šï¼Œè®©è¿™ä¸¤ä¸ªè´¦æˆ·å…±å­˜å‘¢ï¼Ÿ

## ä¸€. https å’Œ SSH çš„åŒºåˆ«ï¼š

1. å‰è€…å¯ä»¥éšæ„å…‹éš† github ä¸Šçš„é¡¹ç›®ï¼Œè€Œä¸ç®¡æ˜¯è°çš„ï¼›è€Œåè€…åˆ™æ˜¯ä½ å¿…é¡»æ˜¯ä½ è¦å…‹éš†çš„é¡¹ç›®çš„æ‹¥æœ‰è€…æˆ–ç®¡ç†å‘˜ï¼Œä¸”éœ€è¦å…ˆæ·»åŠ  SSH key ï¼Œå¦åˆ™æ— æ³•å…‹éš†ã€‚
2. https url åœ¨ push çš„æ—¶å€™æ˜¯éœ€è¦éªŒè¯ç”¨æˆ·åå’Œå¯†ç çš„ï¼›è€Œ SSH åœ¨pushçš„æ—¶å€™ï¼Œæ˜¯ä¸éœ€è¦è¾“å…¥ç”¨æˆ·åçš„ï¼Œå¦‚æœé…ç½® SSH key çš„æ—¶å€™è®¾ç½®äº†å¯†ç ï¼Œåˆ™éœ€è¦è¾“å…¥å¯†ç çš„ï¼Œå¦åˆ™ç›´æ¥æ˜¯ä¸éœ€è¦è¾“å…¥å¯†ç çš„ã€‚

## äºŒ. SSH å·¥ä½œåŸç†

> SSH(Secure Shell) æ˜¯ä¸€ç§åŠ å¯†çš„ç½‘ç»œä¼ è¾“åè®®ï¼Œå¯ä»¥åœ¨ä¸å®‰å…¨çš„ç½‘ç»œä¸­ä¸ºç½‘ç»œæœåŠ¡æä¾›å®‰å…¨çš„ä¼ è¾“ç¯å¢ƒã€‚SSH ä»¥éå¯¹ç§°åŠ å¯†å®ç°èº«ä»½éªŒè¯ï¼Œé€šè¿‡ C/S(client-server) æ¨¡å¼æ¥å®ç°ã€‚

å…·ä½“äº¤äº’è§ä¸‹å›¾ï¼š

![git_04-26_01](https://cdn.jsdelivr.net/gh/oliver556/image-hosting@master/20220426/git_04-26_01.2g5eushgeu4g.webp)

åœ¨æˆ‘ä»¬ä¸Šä¼ ä»£ç åˆ° github æœåŠ¡å™¨çš„è¿‡ç¨‹ä¸­ï¼Œgithub server å°±ä¼šä½œä¸º SSH server æ¥æ¥å—å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå¹¶è¿”å› public keyï¼ˆå³å…¬é’¥ï¼‰ ç»™å®¢æˆ·ç«¯ã€‚è€Œå®¢æˆ·ç«¯å°†ä¼šè¿›è¡Œ public key å’Œ private keyï¼ˆå³ç§é’¥ï¼‰çš„åŒ¹é…æ ¡éªŒï¼Œæœ€ç»ˆå»ºç«‹è¿æ¥ã€‚

åœ¨æ˜ç™½äº† SSH çš„åŸç†ä¹‹åï¼Œä½ å¯èƒ½ä¼šæœ‰ç‚¹ç–‘æƒ‘ï¼Œè¿™ä¸ªå…¬é’¥å’Œç§é’¥æ˜¯æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿä¸‹é¢æˆ‘ä»¬å°±æ¥è§£ç­”è¿™äº›ç–‘é—®ã€‚

## ä¸‰. åŸºæœ¬çš„ Github SSH é…ç½®

Git SSH çš„å…¬é’¥å’Œç§é’¥éƒ½æ˜¯åœ¨å®¢æˆ·ç«¯æ‰‹åŠ¨ç”Ÿæˆçš„ã€‚ä¸€èˆ¬æˆ‘ä»¬ä¼šå°†ç§é’¥ä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼Œå…¬é’¥é…ç½®åœ¨æœåŠ¡ç«¯ã€‚æ­¤å¤„ä»¥ github ä¸ºä¾‹ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥è¿›è¡Œ SSH çš„é…ç½®ã€‚

> é…ç½® SSH ç§˜é’¥ï¼š
> - æ ¹æ® [github æ–‡æ¡£](https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent#adding-your-ssh-key-to-the-ssh-agent) ï¼Œ
  åœ¨å®¢æˆ·ç«¯åˆ›å»º SSH å…¬é’¥å’Œç§é’¥å¯¹ï¼Œå¹¶å°†ç§é’¥æ·»åŠ åˆ°å®¢æˆ·ç«¯çš„ ssh-agent ä¸­ã€‚
> - [å°†å…¬é’¥é…ç½®åœ¨ github çš„ç›¸åº”è´¦æˆ·ä¸­](https://docs.github.com/en/authentication/connecting-to-github-with-ssh/adding-a-new-ssh-key-to-your-github-account)
> - æµ‹è¯•é…ç½®æ˜¯å¦æˆåŠŸ

###  3.1 æ£€æŸ¥æ˜¯å¦æœ‰ SSH key

é¦–å…ˆéœ€è¦æ£€æŸ¥ä½ ç”µè„‘æ˜¯å¦å·²ç»æœ‰ SSH key

```bash
$ cd ~/.ssh
$ ls
```

è¿™ä¸¤ä¸ªå‘½ä»¤å°±æ˜¯æ£€æŸ¥æ˜¯å¦å·²ç»å­˜åœ¨ `id_rsa.pub` æˆ– `id_dsa.pub` æ–‡ä»¶ã€‚

###  3.2 åˆ›å»ºä¸€ä¸ª SSH key

```bash
$ ssh-keygen -t rsa -C "your_email@example.com"
```

> ä»£ç å‚æ•°å«ä¹‰ï¼š
> - -t æŒ‡å®šå¯†é’¥ç±»å‹ï¼Œé»˜è®¤æ˜¯ rsa ï¼Œå¯ä»¥çœç•¥ã€‚
> - -C è®¾ç½®æ³¨é‡Šæ–‡å­—ï¼Œæ¯”å¦‚é‚®ç®±ã€‚
> - -f æŒ‡å®šå¯†é’¥æ–‡ä»¶å­˜å‚¨æ–‡ä»¶åã€‚

ä»¥ä¸Šä»£ç çœç•¥äº† `-f` å‚æ•°ï¼Œå› æ­¤ï¼Œè¿è¡Œä¸Šé¢é‚£æ¡å‘½ä»¤åä¼šè®©ä½ è¾“å…¥ä¸€ä¸ªæ–‡ä»¶åï¼Œç”¨äºä¿å­˜åˆšæ‰ç”Ÿæˆçš„ SSH key ä»£ç ï¼Œå¦‚ï¼š

```bash
Generating public/private rsa key pair.
# Enter file in which to save the key (/c/Users/you/.ssh/id_rsa): [Press enter]
```

å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ä¸è¾“å…¥æ–‡ä»¶åï¼Œä½¿ç”¨é»˜è®¤æ–‡ä»¶åï¼ˆ**å•ä¸ª SSH æ—¶æ¨è**ï¼‰ï¼Œé‚£ä¹ˆå°±ä¼šç”Ÿæˆ `id_rsa` å’Œ `id_rsa.pub` ä¸¤ä¸ªç§˜é’¥æ–‡ä»¶ã€‚

æ¥ç€åˆä¼šæç¤ºä½ è¾“å…¥ä¸¤æ¬¡å¯†ç ï¼ˆè¯¥å¯†ç æ˜¯ä½  push æ–‡ä»¶çš„æ—¶å€™è¦è¾“å…¥çš„å¯†ç ï¼Œè€Œä¸æ˜¯ github ç®¡ç†è€…çš„å¯†ç ï¼‰ï¼Œ

<!--<span style="color: #ff0000;font-size: 14px;">-->
è¿™é‡Œ **ä¸è¦è¾“å…¥å¯†ç **ï¼Œç›´æ¥æŒ‰å›è½¦ã€‚é‚£ä¹ˆ push çš„æ—¶å€™å°±ä¸éœ€è¦è¾“å…¥å¯†ç ï¼Œç›´æ¥æäº¤åˆ° github ä¸Šäº†ï¼Œå¦‚ï¼š
<!--</span>-->

```bash
Enter passphrase (empty for no passphrase):
# Enter same passphrase again:
```

æ¥ä¸‹æ¥ï¼Œå°±ä¼šæ˜¾ç¤ºå¦‚ä¸‹ä»£ç æç¤ºï¼Œå¦‚ï¼š

```
Your identification has been saved in /c/Users/you/.ssh/id_rsa.Enter passphrase
# Your public key has been saved in /c/Users/you/.ssh/id_rsa.pub.
# The key fingerprint is:
# 01:0f:f4:3b:ca:85:d6:17:a1:7d:f0:68:9d:f0:a2:db your_email@example.com
```

å½“ä½ çœ‹åˆ°ä¸Šé¢è¿™æ®µä»£ç çš„æ”¶ï¼Œé‚£å°±è¯´æ˜ï¼Œä½ çš„ SSH key å·²ç»åˆ›å»ºæˆåŠŸï¼Œä½ åªéœ€è¦æ·»åŠ åˆ° github çš„ SSH key ä¸Šå°±å¯ä»¥äº†ã€‚

## 3.3 æµ‹è¯•é…ç½®æ˜¯å¦æˆåŠŸ

```bash
$ ssh -T git@github.com
```

å¦‚æœçœ‹åˆ°å¦‚ä¸‹ç»“æœï¼Œåˆ™è¯æ˜é…ç½®æˆåŠŸï¼Œå¦åˆ™éœ€è¦æ ¹æ®é”™è¯¯æ¶ˆæ¯è¿›è¡Œä¿®æ”¹ã€‚

```
Hi yourusername! Youâ€™ve successfully authenticated, but GitHub does not provide shell access
```

## å››. é…ç½®å¤šä¸ª SSH

### 4.1 ç”Ÿæˆ GitHub SSH

```bash
$ ssh-keygen -t rsa -C "your_email@example.com" -f ~/.ssh/github_id_rsa
```

### 4.2 ç”Ÿæˆ Gitee SSH

```bash
$ ssh-keygen -t rsa -C "your_email@example.com" -f ~/.ssh/gitee_id_rsa
```

### 4.3 ç”Ÿæˆå…¬å¸ SSH

```bash
$ ssh-keygen -t rsa -C "your_email@example.com" -f ~/.ssh/xxx_id_rsa
```

### 4.3 é…ç½® config

åœ¨ `~/.ssh` ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª `config` æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼ˆå…¶ä¸­ Host å’Œ HostName å¡«å†™ git æœåŠ¡å™¨çš„åŸŸåï¼ŒIdentityFile æŒ‡å®šç§é’¥çš„è·¯å¾„ï¼‰

```
# Default github user (first@mail.com)

# GitHub
Host github.com # åˆ«åï¼Œéšä¾¿å®š åé¢é…ç½®åœ°å€æœ‰ç”¨
HostName github.com # è¦è¿æ¥çš„æœåŠ¡å™¨
PreferredAuthentications publickey
IdentityFile ~/.ssh/github_id_rsa # å¯†é’¥æ–‡ä»¶çš„åœ°å€ï¼Œæ³¨æ„æ˜¯ç§é’¥

# Gitee
Host gitee.com
HostName gitee.com
PreferredAuthentications publickey
IdentityFile ~/.ssh/gitee_id_rsa

# GitLab
Host xxx.com
HostName xxx.com
PreferredAuthentications publickey
IdentityFile ~/.ssh/xxx_id_rsa
```

### 4.4 æµ‹è¯•é…ç½®æ˜¯å¦æˆåŠŸ

```bash
$ ssh -T git@github.com
$ ssh -T git@gitee.com
$ ssh -T git@xxx.com
```

```
âœ  ~ ssh -T git@github.com
Hi yourusername! You've successfully authenticated, but GitHub does not provide shell access.
```

## äº”. è§£å†³sshæƒé™é—®é¢˜ï¼ˆï¼‰:

é€šå¸¸ä¸€å°ç”µè„‘ç”Ÿæˆä¸€ä¸ª ssh ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜ï¼Œå½“ä¸€å°ç”µè„‘ç”Ÿæˆå¤šä¸ª ssh çš„æ—¶å€™ï¼Œå°±å¯èƒ½é‡åˆ°è¿™ä¸ªé—®é¢˜ï¼Œè§£å†³æ­¥éª¤å¦‚ä¸‹ï¼š

**1) æŸ¥çœ‹ç³»ç»Ÿ ssh-key ä»£ç†,æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤**

```bash
$ ssh-add -l
```

ä»¥ä¸Šå‘½ä»¤å¦‚æœè¾“å‡º `The agent has no identities.` åˆ™è¡¨ç¤ºæ²¡æœ‰ä»£ç†ã€‚å¦‚æœç³»ç»Ÿæœ‰ä»£ç†ï¼Œå¯ä»¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤æ¸…é™¤ä»£ç†:

```bash
$ ssh-add -D
```

**2). ç„¶åä¾æ¬¡å°†ä¸åŒçš„sshæ·»åŠ ä»£ç†ï¼Œæ‰§è¡Œå‘½ä»¤å¦‚ä¸‹ï¼š**

```
$ ssh-add ~/.ssh/github_id_rsa
$ ssh-add ~/.ssh/gitee_id_rsa
$ ssh-add ~/.ssh/xxx_id_rsa
```

ä½ ä¼šåˆ†åˆ«å¾—åˆ°å¦‚ä¸‹æç¤ºï¼š

```
Identity added: /Users/xxx/.ssh/github_id_rsa (your_email@example.com)
Identity added: /Users/xxx/.ssh/gitee_id_rsa (your_email@example.com)
Identity added: /Users/xxx/.ssh/xxx_id_rsa (your_email@example.com)
```

å¦‚æœä½¿ç”¨ `ssh-add ~/.ssh/id_rsa` çš„æ—¶å€™æŠ¥å¦‚ä¸‹é”™è¯¯ï¼Œåˆ™éœ€è¦å…ˆè¿è¡Œä¸€ä¸‹ `ssh-agent bash` å‘½ä»¤åå†æ‰§è¡Œ `ssh-add` ...ç­‰å‘½ä»¤

```
Could not open a connection to your authentication agent.
```

ç„¶åæŒ‰ç…§ [4.3 é…ç½® config](#_4-3-é…ç½®-config) è¿›è¡Œé…ç½®å³å¯ã€‚

## å…­. è®¾ç½® Git æäº¤çš„ç”¨æˆ·å

### 6.1 å–æ¶ˆå…¨å±€è®¾ç½®

æ˜¯å¦è®¾ç½®è¿‡å…¨å±€çš„ username å’Œ emailï¼Œéƒ½å…ˆè¿›è¡Œå–æ¶ˆã€‚

```bash
$ git config --global --unset user.name
$ git config --global --unset user.email
```

### 6.2 å•ç‹¬è®¾ç½®ç”¨æˆ·å

åœ¨ repo ä¸­ä½¿ç”¨ä¸åŒçš„ç”¨æˆ·è¿›è¡Œæ“ä½œï¼Œè¿›å…¥ repo ç›®å½•åï¼Œéœ€è¦å…ˆè®¾ç½® username å’Œ emailï¼Œç„¶åå†è¿›è¡Œå…¶ä»–æ“ä½œ

```bash
$ git config user.name yourusername

$ git config user.email "youremail"
```

ç„¶åæŸ¥çœ‹è¯¥ repo ç›®å½•ä¸‹ï¼Œä½ çš„ç”¨æˆ·åå’Œå¯†ç ä¿¡æ¯ï¼š

```bash
$ git config user.name

$ git config user.password
```

## ğŸŒŸ. å‘½ä»¤æ€»ç»“

- æŸ¥çœ‹ç”¨æˆ·å ï¼š`git config user.name`
- æŸ¥çœ‹å¯†ç ï¼š `git config user.password`
- æŸ¥çœ‹é‚®ç®±ï¼š`git config user.email`
- æµ‹è¯•sshï¼š`ssh -T git@github.com`

## ğŸŒŸ. å°ç»“

æœ¬æ–‡æ˜¯ç¬”è€…åœ¨å®è·µä¸­çš„è®°å½•ï¼Œä¹Ÿå‚è€ƒäº†ä¸€äº›ç½‘ä¸Šä¼˜ç§€çš„ä½œè€…ç»éªŒï¼Œå¦‚æœ‰é”™è¯¯è¯·æŒ‡å‡ºã€‚

å‚è€ƒèµ„æ–™

- [é€šè¿‡ ssh config é…ç½® Git å¤šè´¦æˆ· SSH ç™»å½•](https://hanpanpan200.github.io/2019/10/14/setup-multiple-git-accounts-by-ssh-config/#%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AA-github-%E8%B4%A6%E6%88%B7%E7%9A%84-SSH)
- [Gité€šè¿‡é…ç½®configç»´æŠ¤å¤šä¸ªè´¦å·ï¼ŒåŒºåˆ†ä¸ªäººè´¦å·å’Œå…¬å¸è´¦å·](https://blog.csdn.net/CoderBruis/article/details/120674608)
- [åŒä¸€å°ç”µè„‘ä¸Šä¸ªäººçš„githubè´¦æˆ·å¦‚ä½•ä¸å…¬å¸çš„gitlabè´¦æˆ·å…±å­˜](https://www.cnblogs.com/hezhi/p/10317642.html)
- [è§£å†³ä½¿ç”¨gitï¼Œsshæ¯æ¬¡éƒ½è¦è¾“å…¥å¯†ç ](https://blog.csdn.net/jasonwang_/article/details/84031521)
- [Gitee - Gité…ç½®å¤šä¸ªSSH-Key](https://gitee.com/help/articles/4229)

æ›´è¿›ä¸€æ­¥é˜…è¯»ï¼Œäº†è§£ SSH çŸ¥è¯†ï¼š[æ˜¯å¦å¿…é¡»æ¯æ¬¡æ·»åŠ  ssh-add](https://segmentfault.com/q/1010000000835302) å’Œ [ã€ŠSSHï¼ŒThe Secure Shellã€‹](https://book.douban.com/subject/2299605/) ä¹¦æœ¬ã€‚
