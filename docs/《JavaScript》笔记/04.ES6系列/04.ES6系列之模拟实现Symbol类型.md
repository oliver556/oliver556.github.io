---
title: ES6 ç³»åˆ—ä¹‹æ¨¡æ‹Ÿå®ç° Symbol ç±»å‹
date: 2021-11-22 21:58:22
permalink: /pages/995271/
categories:
  - å‰ç«¯æŠ€æœ¯
tags:
  - Webå¼€å‘
  - JavaScript
  - ES6ç³»åˆ—
author:
  name: Jamison
  link: https://github.com/oliver556
---

# ES6 ç³»åˆ—ä¹‹æ¨¡æ‹Ÿå®ç° Symbol ç±»å‹

## ğŸ“–. å‰è¨€

å®é™…ä¸Šï¼ŒSymbol çš„å¾ˆå¤šç‰¹æ€§éƒ½æ— æ³•æ¨¡æ‹Ÿå®ç°â€¦â€¦æ‰€ä»¥å…ˆè®©æˆ‘ä»¬å›é¡¾ä¸‹æœ‰å“ªäº›ç‰¹æ€§ï¼Œç„¶åæŒ‘ç‚¹èƒ½å®ç°çš„â€¦â€¦å½“ç„¶åœ¨çœ‹çš„è¿‡ç¨‹ä¸­ï¼Œä½ ä¹Ÿå¯ä»¥æ€è€ƒè¿™ä¸ªç‰¹æ€§æ˜¯å¦èƒ½å®ç°ï¼Œå¦‚æœå¯ä»¥å®ç°ï¼Œè¯¥å¦‚ä½•å®ç°ã€‚

## ä¸€. å›é¡¾

ES6 å¼•å…¥äº†ä¸€ç§æ–°çš„åŸå§‹æ•°æ®ç±»å‹ Symbolï¼Œè¡¨ç¤ºç‹¬ä¸€æ— äºŒçš„å€¼ã€‚

**1. Symbol å€¼é€šè¿‡ Symbol å‡½æ•°ç”Ÿæˆï¼Œä½¿ç”¨ typeofï¼Œç»“æœä¸º "symbol"**

```js
var s = Symbol();
console.log(typeof s); // "symbol"
```

**2. Symbol å‡½æ•°å‰ä¸èƒ½ä½¿ç”¨ new å‘½ä»¤ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚è¿™æ˜¯å› ä¸ºç”Ÿæˆçš„ Symbol æ˜¯ä¸€ä¸ªåŸå§‹ç±»å‹çš„å€¼ï¼Œä¸æ˜¯å¯¹è±¡ã€‚**

**3. instanceof çš„ç»“æœä¸º false**

```js
var s = Symbol('foo');
console.log(s instanceof Symbol); // false
```

**4. Symbol å‡½æ•°å¯ä»¥æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œè¡¨ç¤ºå¯¹ Symbol å®ä¾‹çš„æè¿°ï¼Œä¸»è¦æ˜¯ä¸ºäº†åœ¨æ§åˆ¶å°æ˜¾ç¤ºï¼Œæˆ–è€…è½¬ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œæ¯”è¾ƒå®¹æ˜“åŒºåˆ†ã€‚**

```js
var s1 = Symbol('foo');
console.log(s1); // Symbol(foo)
```

**5. å¦‚æœ Symbol çš„å‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå°±ä¼šè°ƒç”¨è¯¥å¯¹è±¡çš„ toString æ–¹æ³•ï¼Œå°†å…¶è½¬ä¸ºå­—ç¬¦ä¸²ï¼Œç„¶åæ‰ç”Ÿæˆä¸€ä¸ª Symbol å€¼ã€‚**

```js
const obj = {
  toString() {
    return 'abc';
  }
};
const sym = Symbol(obj);
console.log(sym); // Symbol(abc)
```

**6. Symbol å‡½æ•°çš„å‚æ•°åªæ˜¯è¡¨ç¤ºå¯¹å½“å‰ Symbol å€¼çš„æè¿°ï¼Œç›¸åŒå‚æ•°çš„ Symbol å‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸ç›¸ç­‰çš„ã€‚**

```js
// æ²¡æœ‰å‚æ•°çš„æƒ…å†µ
var s1 = Symbol();
var s2 = Symbol();

console.log(s1 === s2); // false

// æœ‰å‚æ•°çš„æƒ…å†µ
var s1 = Symbol('foo');
var s2 = Symbol('foo');

console.log(s1 === s2); // false
```

**7. Symbol å€¼ä¸èƒ½ä¸å…¶ä»–ç±»å‹çš„å€¼è¿›è¡Œè¿ç®—ï¼Œä¼šæŠ¥é”™ã€‚**

```js
var sym = Symbol('My symbol');

console.log("your symbol is " + sym); // TypeError: can't convert symbol to string
```

**8. Symbol å€¼å¯ä»¥æ˜¾å¼è½¬ä¸ºå­—ç¬¦ä¸²ã€‚**

```js
var sym = Symbol('My symbol');

console.log(String(sym)); // 'Symbol(My symbol)'
console.log(sym.toString()); // 'Symbol(My symbol)'
```

**9. Symbol å€¼å¯ä»¥ä½œä¸ºæ ‡è¯†ç¬¦ï¼Œç”¨äºå¯¹è±¡çš„å±æ€§åï¼Œå¯ä»¥ä¿è¯ä¸ä¼šå‡ºç°åŒåçš„å±æ€§ã€‚**

```js
var mySymbol = Symbol();

// ç¬¬ä¸€ç§å†™æ³•
var a = {};
a[mySymbol] = 'Hello!';

// ç¬¬äºŒç§å†™æ³•
var a = {
  [mySymbol]: 'Hello!'
};

// ç¬¬ä¸‰ç§å†™æ³•
var a = {};
Object.defineProperty(a, mySymbol, { value: 'Hello!' });

// ä»¥ä¸Šå†™æ³•éƒ½å¾—åˆ°åŒæ ·ç»“æœ
console.log(a[mySymbol]); // "Hello!"
```

**10. Symbol ä½œä¸ºå±æ€§åï¼Œè¯¥å±æ€§ä¸ä¼šå‡ºç°åœ¨ for...inã€for...of å¾ªç¯ä¸­ï¼Œä¹Ÿä¸ä¼šè¢« Object.keys()ã€Object.getOwnPropertyNames()ã€JSON.stringify() è¿”å›ã€‚ä½†æ˜¯ï¼Œå®ƒä¹Ÿä¸æ˜¯ç§æœ‰å±æ€§ï¼Œ
æœ‰ä¸€ä¸ª Object.getOwnPropertySymbols æ–¹æ³•ï¼Œå¯ä»¥è·å–æŒ‡å®šå¯¹è±¡çš„æ‰€æœ‰ Symbol å±æ€§åã€‚**

```js
var obj = {};
var a = Symbol('a');
var b = Symbol('b');

obj[a] = 'Hello';
obj[b] = 'World';

var objectSymbols = Object.getOwnPropertySymbols(obj);

console.log(objectSymbols);
// [Symbol(a), Symbol(b)]
```

**11. å¦‚æœæˆ‘ä»¬å¸Œæœ›ä½¿ç”¨åŒä¸€ä¸ª Symbol å€¼ï¼Œå¯ä»¥ä½¿ç”¨ Symbol.forã€‚å®ƒæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œç„¶åæœç´¢æœ‰æ²¡æœ‰ä»¥è¯¥å‚æ•°ä½œä¸ºåç§°çš„ Symbol å€¼ã€‚å¦‚æœæœ‰ï¼Œå°±è¿”å›è¿™ä¸ª Symbol å€¼ï¼Œå¦åˆ™å°±æ–°å»ºå¹¶è¿”å›ä¸€ä¸ªä»¥è¯¥å­—ç¬¦ä¸²ä¸ºåç§°çš„ Symbol å€¼ã€‚**

```js
var s1 = Symbol.for('foo');
var s2 = Symbol.for('foo');

console.log(s1 === s2); // true
```

**12. Symbol.keyFor æ–¹æ³•è¿”å›ä¸€ä¸ªå·²ç™»è®°çš„ Symbol ç±»å‹å€¼çš„ keyã€‚**

```js
var s1 = Symbol.for("foo");
console.log(Symbol.keyFor(s1)); // "foo"

var s2 = Symbol("foo");
console.log(Symbol.keyFor(s2) ); // undefined
```

## äºŒ. åˆ†æ

çœ‹å®Œä»¥ä¸Šçš„ç‰¹æ€§ï¼Œä½ è§‰å¾—å“ªäº›ç‰¹æ€§æ˜¯å¯ä»¥æ¨¡æ‹Ÿå®ç°çš„å‘¢ï¼Ÿ

å¦‚æœæˆ‘ä»¬è¦æ¨¡æ‹Ÿå®ç°ä¸€ä¸ª Symbol çš„è¯ï¼ŒåŸºæœ¬çš„æ€è·¯å°±æ˜¯æ„å»ºä¸€ä¸ª Symbol å‡½æ•°ï¼Œç„¶åç›´æ¥è¿”å›ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„å€¼ã€‚

ä¸è¿‡åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹ [è§„èŒƒ](http://www.ecma-international.org/ecma-262/6.0/#sec-symbol-description) ä¸­è°ƒç”¨ Symbol æ—¶åˆ°åº•åšäº†å“ªäº›å·¥ä½œï¼š

> Symbol ( [ description ] )

> When Symbol is called with optional argument description, the following steps are taken:

> 1. If NewTarget is not undefined, throw a TypeError exception.
> 2. If description is undefined, var descString be undefined.
> 3. Else, var descString be ToString(description).
> 4. ReturnIfAbrupt(descString).
> 5. Return a new unique Symbol value whose [[Description]] value is descString.

å½“è°ƒç”¨ Symbol çš„æ—¶å€™ï¼Œä¼šé‡‡ç”¨ä»¥ä¸‹æ­¥éª¤ï¼š

1. å¦‚æœä½¿ç”¨ new ï¼Œå°±æŠ¥é”™
2. å¦‚æœ description æ˜¯ undefinedï¼Œè®© descString ä¸º undefined
3. å¦åˆ™ è®© descString ä¸º ToString(description)
4. å¦‚æœæŠ¥é”™ï¼Œå°±è¿”å›
5. è¿”å›ä¸€ä¸ªæ–°çš„å”¯ä¸€çš„ Symbol å€¼ï¼Œå®ƒçš„å†…éƒ¨å±æ€§ [[Description]] å€¼ä¸º descString

è€ƒè™‘åˆ°è¿˜éœ€è¦å®šä¹‰ä¸€ä¸ª [[Description]] å±æ€§ï¼Œå¦‚æœç›´æ¥è¿”å›ä¸€ä¸ªåŸºæœ¬ç±»å‹çš„å€¼ï¼Œæ˜¯æ— æ³•åšåˆ°è¿™ä¸€ç‚¹çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€ç»ˆè¿˜æ˜¯è¿”å›ä¸€ä¸ªå¯¹è±¡ã€‚

## ä¸‰. ç¬¬ä¸€ç‰ˆ

å‚ç…§ç€è§„èŒƒï¼Œå…¶å®æˆ‘ä»¬å·²ç»å¯ä»¥å¼€å§‹å†™èµ·æ¥äº†ï¼š

```js
// ç¬¬ä¸€ç‰ˆ
(function() {
    var root = this;

    var SymbolPolyfill = function Symbol(description) {

        // å®ç°ç‰¹æ€§ç¬¬ 2 ç‚¹ï¼šSymbol å‡½æ•°å‰ä¸èƒ½ä½¿ç”¨ new å‘½ä»¤
        if (this instanceof SymbolPolyfill) throw new TypeError('Symbol is not a constructor');

        // å®ç°ç‰¹æ€§ç¬¬ 5 ç‚¹ï¼šå¦‚æœ Symbol çš„å‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå°±ä¼šè°ƒç”¨è¯¥å¯¹è±¡çš„ toString æ–¹æ³•ï¼Œå°†å…¶è½¬ä¸ºå­—ç¬¦ä¸²ï¼Œç„¶åæ‰ç”Ÿæˆä¸€ä¸ª Symbol å€¼ã€‚
        var descString = description === undefined ? undefined : String(description)

        var symbol = Object.create(null)

        Object.defineProperties(symbol, {
            '__Description__': {
                value: descString,
                writable: false,
                enumerable: false,
                configurable: false
            }
        });

        // å®ç°ç‰¹æ€§ç¬¬ 6 ç‚¹ï¼Œå› ä¸ºè°ƒç”¨è¯¥æ–¹æ³•ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œä¸¤ä¸ªå¯¹è±¡ä¹‹é—´ï¼Œåªè¦å¼•ç”¨ä¸åŒï¼Œå°±ä¸ä¼šç›¸åŒ
        return symbol;
    }

    root.SymbolPolyfill = SymbolPolyfill;
})();
```

åªæ˜¯å‚ç…§ç€è§„èŒƒï¼Œæˆ‘ä»¬å·²ç»å®ç°äº†ç‰¹æ€§çš„ç¬¬ 2ã€5ã€6 ç‚¹ã€‚

## å››. ç¬¬äºŒç‰ˆ

æˆ‘ä»¬æ¥çœ‹çœ‹å…¶ä»–çš„ç‰¹æ€§è¯¥å¦‚ä½•å®ç°ï¼š

**1. ä½¿ç”¨ typeofï¼Œç»“æœä¸º "symbol"ã€‚**

åˆ©ç”¨ ES5ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½ä¿®æ”¹ typeof æ“ä½œç¬¦çš„ç»“æœï¼Œæ‰€ä»¥è¿™ä¸ªæ— æ³•å®ç°ã€‚

**3. instanceof çš„ç»“æœä¸º false**

å› ä¸ºä¸æ˜¯é€šè¿‡ new çš„æ–¹å¼å®ç°çš„ï¼Œæ‰€ä»¥ instanceof çš„ç»“æœè‡ªç„¶æ˜¯ falseã€‚

**4. Symbol å‡½æ•°å¯ä»¥æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œè¡¨ç¤ºå¯¹ Symbol å®ä¾‹çš„æè¿°ã€‚ä¸»è¦æ˜¯ä¸ºäº†åœ¨æ§åˆ¶å°æ˜¾ç¤ºï¼Œæˆ–è€…è½¬ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œæ¯”è¾ƒå®¹æ˜“åŒºåˆ†ã€‚**

å½“æˆ‘ä»¬æ‰“å°ä¸€ä¸ªåŸç”Ÿ Symbol å€¼çš„æ—¶å€™ï¼š

```js
console.log(Symbol('1')); // Symbol(1)
```

å¯æ˜¯æˆ‘ä»¬æ¨¡æ‹Ÿå®ç°çš„æ—¶å€™è¿”å›çš„å´æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥è¿™ä¸ªä¹Ÿæ˜¯æ— æ³•å®ç°çš„ï¼Œå½“ç„¶ä½ ä¿®æ”¹ console.log è¿™ä¸ªæ–¹æ³•æ˜¯å¦è®²ã€‚

**8. Symbol å€¼å¯ä»¥æ˜¾å¼è½¬ä¸ºå­—ç¬¦ä¸²ã€‚**

```js
var sym = Symbol('My symbol');

console.log(String(sym)); // 'Symbol(My symbol)'
console.log(sym.toString()); // 'Symbol(My symbol)'
```

å½“è°ƒç”¨ String æ–¹æ³•çš„æ—¶å€™ï¼Œå¦‚æœè¯¥å¯¹è±¡æœ‰ toString æ–¹æ³•ï¼Œå°±ä¼šè°ƒç”¨è¯¥ toString æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦ç»™è¿”å›çš„å¯¹è±¡æ·»åŠ ä¸€ä¸ª toString æ–¹æ³•ï¼Œå³å¯å®ç°è¿™ä¸¤ä¸ªæ•ˆæœã€‚

```js
// ç¬¬äºŒç‰ˆ

// å‰é¢é¢ä»£ç ç›¸åŒ â€¦â€¦

var symbol = Object.create({
    toString: function() {
        return 'Symbol(' + this.__Description__ + ')';
    },
});

// åé¢ä»£ç ç›¸åŒ â€¦â€¦
```

## äº”. ç¬¬ä¸‰ç‰ˆ

**9. Symbol å€¼å¯ä»¥ä½œä¸ºæ ‡è¯†ç¬¦ï¼Œç”¨äºå¯¹è±¡çš„å±æ€§åï¼Œå¯ä»¥ä¿è¯ä¸ä¼šå‡ºç°åŒåçš„å±æ€§ã€‚**

çœ‹ç€å¥½åƒæ²¡ä»€ä¹ˆï¼Œè¿™ç‚¹å…¶å®å’Œç¬¬ 8 ç‚¹æ˜¯å†²çªçš„ï¼Œè¿™æ˜¯å› ä¸ºå½“æˆ‘ä»¬æ¨¡æ‹Ÿçš„æ‰€è°“ Symbol å€¼å…¶å®æ˜¯ä¸€ä¸ªæœ‰ç€ toString æ–¹æ³•çš„ å¯¹è±¡ï¼Œå½“å¯¹è±¡ä½œä¸ºå¯¹è±¡çš„å±æ€§åçš„æ—¶å€™ï¼Œå°±ä¼šè¿›è¡Œéšå¼ç±»å‹è½¬æ¢ï¼Œ è¿˜æ˜¯ä¼šè°ƒç”¨æˆ‘ä»¬æ·»åŠ çš„ toString æ–¹æ³•ï¼Œ
å¯¹äº Symbol('foo') å’Œ Symbol('foo')ä¸¤ä¸ª Symbol å€¼ï¼Œè™½ç„¶æè¿°ä¸€æ ·ï¼Œä½†æ˜¯å› ä¸ºæ˜¯ä¸¤ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥å¹¶ä¸ç›¸ç­‰ï¼Œä½†æ˜¯å½“ä½œä¸ºå¯¹è±¡çš„å±æ€§åçš„æ—¶å€™ï¼Œ éƒ½ä¼šéšå¼è½¬æ¢ä¸º `Symbol(foo)` å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šé€ æˆåŒåçš„å±æ€§ã€‚ä¸¾ä¸ªä¾‹å­ï¼š

```js
var a = SymbolPolyfill('foo');
var b = SymbolPolyfill('foo');

console.log(a ===  b); // false

var o = {};
o[a] = 'hello';
o[b] = 'hi';

console.log(o); // {Symbol(foo): 'hi'}
```

ä¸ºäº†é˜²æ­¢ä¸ä¼šå‡ºç°åŒåçš„å±æ€§ï¼Œæ¯•ç«Ÿè¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç‰¹æ€§ï¼Œè¿«ä¸å¾—å·²ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ toString æ–¹æ³•ï¼Œè®©å®ƒè¿”å›ä¸€ä¸ªå”¯ä¸€å€¼ï¼Œæ‰€ä»¥ç¬¬ 8 ç‚¹å°±æ— æ³•å®ç°äº†ï¼Œè€Œä¸”æˆ‘ä»¬è¿˜éœ€è¦å†å†™ä¸€ä¸ªç”¨æ¥ç”Ÿæˆ å”¯ä¸€å€¼çš„æ–¹æ³•ï¼Œ
å°±å‘½åä¸º generateNameï¼Œæˆ‘ä»¬å°†è¯¥å”¯ä¸€å€¼æ·»åŠ åˆ°è¿”å›å¯¹è±¡çš„ __Name__ å±æ€§ä¸­ä¿å­˜ä¸‹æ¥ã€‚

```js
// ç¬¬ä¸‰ç‰ˆ
(function() {
    var root = this;

    var generateName = (function(){
        var postfix = 0;
        return function(descString){
            postfix++;
            return '@@' + descString + '_' + postfix
        }
    })()

    var SymbolPolyfill = function Symbol(description) {

        if (this instanceof SymbolPolyfill) throw new TypeError('Symbol is not a constructor');

        var descString = description === undefined ? undefined : String(description)

        var symbol = Object.create({
            toString: function() {
                return this.__Name__;
            }
        })

        Object.defineProperties(symbol, {
            '__Description__': {
                value: descString,
                writable: false,
                enumerable: false,
                configurable: false
            },
            '__Name__': {
                value: generateName(descString),
                writable: false,
                enumerable: false,
                configurable: false
            }
        });

        return symbol;
    }


    root.SymbolPolyfill = SymbolPolyfill;

})()
```

æ­¤æ—¶å†çœ‹ä¸‹è¿™ä¸ªä¾‹å­ï¼š

```js
var a = SymbolPolyfill('foo');
var b = SymbolPolyfill('foo');

console.log(a ===  b); // false

var o = {};
o[a] = 'hello';
o[b] = 'hi';

console.log(o); // Object { "@@foo_1": "hello", "@@foo_2": "hi" }
```

## å…­. ç¬¬å››ç‰ˆ

æˆ‘ä»¬å†çœ‹çœ‹æ¥ä¸‹æ¥çš„ç‰¹æ€§ã€‚

**7.Symbol å€¼ä¸èƒ½ä¸å…¶ä»–ç±»å‹çš„å€¼è¿›è¡Œè¿ç®—ï¼Œä¼šæŠ¥é”™ã€‚**

ä»¥ `+` æ“ä½œç¬¦ä¸ºä¾‹ï¼Œå½“è¿›è¡Œéšå¼ç±»å‹è½¬æ¢çš„æ—¶å€™ï¼Œä¼šå…ˆè°ƒç”¨å¯¹è±¡çš„ valueOf æ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰è¿”å›åŸºæœ¬å€¼ï¼Œå°±ä¼šå†è°ƒç”¨ toString æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘åœ¨ valueOf æ–¹æ³•ä¸­è¿›è¡ŒæŠ¥é”™ï¼Œæ¯”å¦‚ï¼š

```js
var symbol = Object.create({
    valueOf: function() {
        throw new Error('Cannot convert a Symbol value')
    }
})

console.log('1' + symbol); // æŠ¥é”™
```

çœ‹ç€å¾ˆç®€å•çš„è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œå¯æ˜¯å¦‚æœæˆ‘ä»¬æ˜¯æ˜¾å¼è°ƒç”¨ valueOf æ–¹æ³•å‘¢ï¼Ÿå¯¹äºä¸€ä¸ªåŸç”Ÿçš„ Symbol å€¼ï¼š

```js
var s1 = Symbol('foo')
console.log(s1.valueOf()); // Symbol(foo)
```

æ˜¯çš„ï¼Œå¯¹äºåŸç”Ÿ Symbolï¼Œæ˜¾å¼è°ƒç”¨ valueOf æ–¹æ³•ï¼Œä¼šç›´æ¥è¿”å›è¯¥ Symbol å€¼ï¼Œè€Œæˆ‘ä»¬åˆæ— æ³•åˆ¤æ–­æ˜¯æ˜¾å¼è¿˜æ˜¯éšå¼çš„è°ƒç”¨ï¼Œæ‰€ä»¥è¿™ä¸ªæˆ‘ä»¬å°±åªèƒ½å®ç°ä¸€åŠï¼Œè¦ä¸ç„¶å®ç°éšå¼è°ƒç”¨æŠ¥é”™ï¼Œè¦ä¸ç„¶å®ç°æ˜¾å¼è°ƒç”¨è¿”å›è¯¥å€¼ï¼Œé‚£â€¦â€¦æˆ‘ä»¬é€‰æ‹©ä¸æŠ¥é”™çš„é‚£ä¸ªå§ï¼Œå³åè€…ã€‚

æˆ‘ä»¬è¿«ä¸å¾—å·²çš„ä¿®æ”¹ valueOf å‡½æ•°ï¼š

```js
// ç¬¬å››ç‰ˆ
// å‰é¢é¢ä»£ç ç›¸åŒ â€¦â€¦

var symbol = Object.create({
    toString: function() {
        return this.__Name__;
    },
    valueOf: function() {
        return this;
    }
});
// åé¢ä»£ç ç›¸åŒ â€¦â€¦
```

## ä¸ƒ. ç¬¬äº”ç‰ˆ

**10. Symbol ä½œä¸ºå±æ€§åï¼Œè¯¥å±æ€§ä¸ä¼šå‡ºç°åœ¨ for...inã€for...of å¾ªç¯ä¸­ï¼Œä¹Ÿä¸ä¼šè¢« Object.keys()ã€Object.getOwnPropertyNames()ã€JSON.stringify() è¿”å›ã€‚ä½†æ˜¯ï¼Œå®ƒä¹Ÿä¸æ˜¯ç§æœ‰å±æ€§ï¼Œ
æœ‰ä¸€ä¸ª Object.getOwnPropertySymbols æ–¹æ³•ï¼Œå¯ä»¥è·å–æŒ‡å®šå¯¹è±¡çš„æ‰€æœ‰ Symbol å±æ€§åã€‚**

å—¯ï¼Œæ— æ³•å®ç°ã€‚

**11. æœ‰æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›é‡æ–°ä½¿ç”¨åŒä¸€ä¸ªSymbolå€¼ï¼ŒSymbol.foræ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚å®ƒæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œç„¶åæœç´¢æœ‰æ²¡æœ‰ä»¥è¯¥å‚æ•°ä½œä¸ºåç§°çš„Symbolå€¼ã€‚å¦‚æœæœ‰ï¼Œå°±è¿”å›è¿™ä¸ªSymbolå€¼ï¼Œå¦åˆ™å°±æ–°å»ºå¹¶è¿”å›ä¸€ä¸ªä»¥è¯¥å­—ç¬¦ä¸²ä¸ºåç§°çš„Symbolå€¼ã€‚**

è¿™ä¸ªå®ç°ç±»ä¼¼äºå‡½æ•°è®°å¿†ï¼Œæˆ‘ä»¬å»ºç«‹ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥å‚¨å­˜å·²ç»åˆ›å»ºçš„ Symbol å€¼å³å¯ã€‚

**12. Symbol.keyFor æ–¹æ³•è¿”å›ä¸€ä¸ªå·²ç™»è®°çš„ Symbol ç±»å‹å€¼çš„ keyã€‚**

éå† forMap,æŸ¥æ‰¾è¯¥å€¼å¯¹åº”çš„é”®å€¼å³å¯ã€‚

```js
// ç¬¬äº”ç‰ˆ
// å‰é¢ä»£ç ç›¸åŒ â€¦â€¦
var SymbolPolyfill = function() { ... }

var forMap = {};

Object.defineProperties(SymbolPolyfill, {
    'for': {
        value: function(description) {
            var descString = description === undefined ? undefined : String(description)
            return forMap[descString] ? forMap[descString] : forMap[descString] = SymbolPolyfill(descString);
        },
        writable: true,
        enumerable: false,
        configurable: true
    },
    'keyFor': {
        value: function(symbol) {
            for (var key in forMap) {
                if (forMap[key] === symbol) return key;
            }
        },
        writable: true,
        enumerable: false,
        configurable: true
    }
});
// åé¢ä»£ç ç›¸åŒ â€¦â€¦
```

## å…«. å®Œæ•´å®ç°

ç»¼ä¸Šæ‰€è¿°ï¼š

æ— æ³•å®ç°çš„ç‰¹æ€§æœ‰ï¼š1ã€4ã€7ã€8ã€10

å¯ä»¥å®ç°çš„ç‰¹æ€§æœ‰ï¼š2ã€3ã€5ã€6ã€9ã€11ã€12

æœ€åçš„å®ç°å¦‚ä¸‹:

```js
(function() {
    var root = this;

    var generateName = (function(){
        var postfix = 0;
        return function(descString){
            postfix++;
            return '@@' + descString + '_' + postfix
        }
    })()

    var SymbolPolyfill = function Symbol(description) {

        if (this instanceof SymbolPolyfill) throw new TypeError('Symbol is not a constructor');

        var descString = description === undefined ? undefined : String(description)

        var symbol = Object.create({
            toString: function() {
                return this.__Name__;
            },
            valueOf: function() {
                return this;
            }
        })

        Object.defineProperties(symbol, {
            '__Description__': {
                value: descString,
                writable: false,
                enumerable: false,
                configurable: false
            },
            '__Name__': {
                value: generateName(descString),
                writable: false,
                enumerable: false,
                configurable: false
            }
        });

        return symbol;
    }

    var forMap = {};

    Object.defineProperties(SymbolPolyfill, {
        'for': {
            value: function(description) {
                var descString = description === undefined ? undefined : String(description)
                return forMap[descString] ? forMap[descString] : forMap[descString] = SymbolPolyfill(descString);
            },
            writable: true,
            enumerable: false,
            configurable: true
        },
        'keyFor': {
            value: function(symbol) {
                for (var key in forMap) {
                    if (forMap[key] === symbol) return key;
                }
            },
            writable: true,
            enumerable: false,
            configurable: true
        }
    });

    root.SymbolPolyfill = SymbolPolyfill;

})()
```