---
title: ES6 Á≥ªÂàó‰πãÂºÇÊ≠•Â§ÑÁêÜÂÆûÊàò
date: 2021-11-29 18:27:14
permalink: /pages/f40265/
categories:
  - ÂâçÁ´ØÊäÄÊúØ
tags:
  - WebÂºÄÂèë
  - JavaScript
  - ES6Á≥ªÂàó
---

# ES6 Á≥ªÂàó‰πãÂºÇÊ≠•Â§ÑÁêÜÂÆûÊàò

## üìñ. ÂâçË®Ä

Êàë‰ª¨‰ª• `Êü•ÊâæÊåáÂÆöÁõÆÂΩï‰∏ãÁöÑÊúÄÂ§ßÊñá‰ª∂` ‰∏∫‰æãÔºåÊÑüÂèó‰ªé

ÂõûË∞ÉÂáΩÊï∞ ‚Üí Promise ‚Üí Generator ‚Üí Async

ÂºÇÊ≠•Â§ÑÁêÜÊñπÂºèÁöÑÊîπÂèò„ÄÇ

## ‰∏Ä. API ‰ªãÁªç

‰∏∫‰∫ÜÂÆûÁé∞Ëøô‰∏™ÂäüËÉΩÔºåÊàë‰ª¨ÈúÄË¶ÅÁî®Âà∞Âá†‰∏™ Nodejs ÁöÑ APIÔºåÊâÄ‰ª•Êàë‰ª¨Êù•ÁÆÄÂçï‰ªãÁªç‰∏Ä‰∏ã„ÄÇ

### 1. fs.readdir

`readdir` ÊñπÊ≥ïÁî®‰∫éËØªÂèñÁõÆÂΩïÔºåËøîÂõû‰∏Ä‰∏™ÂåÖÂê´Êñá‰ª∂ÂíåÁõÆÂΩïÁöÑÊï∞ÁªÑ„ÄÇ

### 2. fs.stat

`stat` ÊñπÊ≥ïÁöÑÂèÇÊï∞ÊòØ‰∏Ä‰∏™Êñá‰ª∂ÊàñÁõÆÂΩïÔºåÂÆÉ‰∫ßÁîü‰∏Ä‰∏™ÂØπË±°ÔºåËØ•ÂØπË±°ÂåÖÂê´‰∫ÜËØ•Êñá‰ª∂ÊàñÁõÆÂΩïÁöÑÂÖ∑‰Ωì‰ø°ÊÅØ„ÄÇÊ≠§Â§ñÔºåËØ•ÂØπË±°ËøòÊúâ‰∏Ä‰∏™ `isFile()` ÊñπÊ≥ïÂèØ‰ª•Âà§Êñ≠Ê≠£Âú®Â§ÑÁêÜÁöÑÂà∞Â∫ïÊòØ‰∏Ä‰∏™Êñá‰ª∂ÔºåËøòÊòØ‰∏Ä‰∏™ÁõÆÂΩï„ÄÇ


## ‰∫å. ÊÄùË∑ØÂàÜÊûê

Êàë‰ª¨Âü∫Êú¨ÁöÑÂÆûÁé∞ÊÄùË∑ØÂ∞±ÊòØÔºö

1. Áî® `fs.readdir` Ëé∑ÂèñÊåáÂÆöÁõÆÂΩïÁöÑÂÜÖÂÆπ‰ø°ÊÅØ 
2. Âæ™ÁéØÈÅçÂéÜÂÜÖÂÆπ‰ø°ÊÅØÔºå‰ΩøÁî® `fs.stat` Ëé∑ÂèñËØ•Êñá‰ª∂ÊàñËÄÖÁõÆÂΩïÁöÑÂÖ∑‰Ωì‰ø°ÊÅØ 
3. Â∞ÜÂÖ∑‰Ωì‰ø°ÊÅØÂÇ®Â≠òËµ∑Êù• 
4. ÂΩìÂÖ®ÈÉ®ÂÇ®Â≠òËµ∑Êù•ÂêéÔºåÁ≠õÈÄâÂÖ∂‰∏≠ÁöÑÊòØÊñá‰ª∂ÁöÑ‰ø°ÊÅØ 
5. ÈÅçÂéÜÊØîËæÉÔºåÊâæÂá∫ÊúÄÂ§ßÊñá‰ª∂ 
6. Ëé∑ÂèñÂπ∂ËøîÂõûÊúÄÂ§ßÊñá‰ª∂

ÁÑ∂ÂêéÊàë‰ª¨Áõ¥Êé•‰∏ä‰ª£Á†ÅÂêß„ÄÇ

## ‰∏â. ÂõûË∞ÉÂáΩÊï∞

```js
var fs = require('fs');
var path = require('path');

function findLargest(dir, cb) {
    // ËØªÂèñÁõÆÂΩï‰∏ãÁöÑÊâÄÊúâÊñá‰ª∂
    fs.readdir(dir, function(er, files) {
        if (er) return cb(er);

        var counter = files.length;
        var errored = false;
        var stats = [];

        files.forEach(function(file, index) {
            // ËØªÂèñÊñá‰ª∂‰ø°ÊÅØ
            fs.stat(path.join(dir, file), function(er, stat) {

                if (errored) return;

                if (er) {
                    errored = true;
                    return cb(er);
                }

                stats[index] = stat;

                // ‰∫ãÂÖàÁÆóÂ•ΩÊúâÂ§öÂ∞ë‰∏™Êñá‰ª∂ÔºåËØªÂÆå 1 ‰∏™Êñá‰ª∂‰ø°ÊÅØÔºåËÆ°Êï∞Âáè 1ÔºåÂΩì‰∏∫ 0 Êó∂ÔºåËØ¥ÊòéËØªÂèñÂÆåÊØïÔºåÊ≠§Êó∂ÊâßË°åÊúÄÁªàÁöÑÊØîËæÉÊìç‰Ωú
                if (--counter == 0) {

                    var largest = stats
                        .filter(function(stat) { return stat.isFile() })
                        .reduce(function(prev, next) {
                            if (prev.size > next.size) return prev
                            return next
                        })

                    cb(null, files[stats.indexOf(largest)])
                }
            })
        })
    })
}
```

‰ΩøÁî®ÊñπÂºè‰∏∫Ôºö

```js
// Êü•ÊâæÂΩìÂâçÁõÆÂΩïÊúÄÂ§ßÁöÑÊñá‰ª∂
findLargest('./', function(er, filename) {
    if (er) return console.error(er)
    console.log('largest file was:', filename)
});
```

## Âõõ. Promise

```js
var fs = require('fs');
var path = require('path');

var readDir = function(dir) {
    return new Promise(function(resolve, reject) {
        fs.readdir(dir, function(err, files) {
            if (err) reject(err);
            resolve(files)
        })
    })
}

var stat = function(path) {
    return new Promise(function(resolve, reject) {
        fs.stat(path, function(err, stat) {
            if (err) reject(err)
            resolve(stat)
        })
    })
}

function findLargest(dir) {
    return readDir(dir)
        .then(function(files) {
            let promises = files.map(file => stat(path.join(dir, file)))
            return Promise.all(promises).then(function(stats) {
                return { stats, files }
            })
        })
        .then(data => {

            let largest = data.stats
                .filter(function(stat) { return stat.isFile() })
                .reduce((prev, next) => {
                    if (prev.size > next.size) return prev
                    return next
                })

            return data.files[data.stats.indexOf(largest)]
        })

}
```

‰ΩøÁî®ÊñπÂºè‰∏∫Ôºö

```js
findLargest('./')
.then(function(filename) {
    console.log('largest file was:', filename);
})
.catch(function() {
    console.log(error);
});
```

## ‰∫î. Generator

```js
var fs = require('fs');
var path = require('path');

var co = require('co')

var readDir = function(dir) {
    return new Promise(function(resolve, reject) {
        fs.readdir(dir, function(err, files) {
            if (err) reject(err);
            resolve(files)
        })
    })
}

var stat = function(path) {
    return new Promise(function(resolve, reject) {
        fs.stat(path, function(err, stat) {
            if (err) reject(err)
            resolve(stat)
        })
    })
}

function* findLargest(dir) {
    var files = yield readDir(dir);
    var stats = yield files.map(function(file) {
        return stat(path.join(dir, file))
    })

    let largest = stats
        .filter(function(stat) { return stat.isFile() })
        .reduce((prev, next) => {
            if (prev.size > next.size) return prev
            return next
        })

    return files[stats.indexOf(largest)]

}
```

‰ΩøÁî®ÊñπÂºè‰∏∫Ôºö

```js
co(findLargest, './')
.then(function(filename) {
    console.log('largest file was:', filename);
})
.catch(function() {
    console.log(error);
});
```

## ÂÖ≠. Async

```js
var fs = require('fs');
var path = require('path');

var readDir = function(dir) {
    return new Promise(function(resolve, reject) {
        fs.readdir(dir, function(err, files) {
            if (err) reject(err);
            resolve(files)
        })
    })
}

var stat = function(path) {
    return new Promise(function(resolve, reject) {
        fs.stat(path, function(err, stat) {
            if (err) reject(err)
            resolve(stat)
        })
    })
}

async function findLargest(dir) {
    var files = await readDir(dir);

    let promises = files.map(file => stat(path.join(dir, file)))
    var stats = await Promise.all(promises)

    let largest = stats
        .filter(function(stat) { return stat.isFile() })
        .reduce((prev, next) => {
            if (prev.size > next.size) return prev
            return next
        })

    return files[stats.indexOf(largest)]

}
```

‰ΩøÁî®ÊñπÂºè‰∏∫Ôºö

```js
findLargest('./')
.then(function(filename) {
    console.log('largest file was:', filename);
})
.catch(function() {
    console.log(error);
});
```
