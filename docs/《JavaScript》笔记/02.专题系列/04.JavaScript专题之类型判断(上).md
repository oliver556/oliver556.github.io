---
title: JavaScript ä¸“é¢˜ä¹‹ç±»å‹åˆ¤æ–­(ä¸Š)
date: 2021-10-21 17:53:42
permalink: /pages/6e737b/
categories:
  - ã€ŠJavaScriptã€‹ç¬”è®°
  - ä¸“é¢˜ç³»åˆ—
tags:
  - 
---

# JavaScript ä¸“é¢˜ä¹‹ç±»å‹åˆ¤æ–­(ä¸Š)

## ğŸ“–. å‰è¨€

ç±»å‹åˆ¤æ–­åœ¨ web å¼€å‘ä¸­æœ‰éå¸¸å¹¿æ³›çš„åº”ç”¨ï¼Œç®€å•çš„æœ‰åˆ¤æ–­æ•°å­—è¿˜æ˜¯å­—ç¬¦ä¸²ï¼Œè¿›é˜¶ä¸€ç‚¹çš„æœ‰åˆ¤æ–­æ•°ç»„è¿˜æ˜¯å¯¹è±¡ï¼Œå†è¿›é˜¶ä¸€ç‚¹çš„æœ‰åˆ¤æ–­æ—¥æœŸã€æ­£åˆ™ã€é”™è¯¯ç±»å‹ï¼Œå†å†è¿›é˜¶ä¸€ç‚¹è¿˜æœ‰æ¯”å¦‚åˆ¤æ–­ plainObjectã€ç©ºå¯¹è±¡ã€Window å¯¹è±¡ç­‰ç­‰ã€‚

ä»¥ä¸Šéƒ½ä¼šè®²ï¼Œä»Šå¤©æ˜¯ä¸ŠåŠåœºã€‚

## ä¸€. typeof

æˆ‘ä»¬æœ€æœ€å¸¸ç”¨çš„è«è¿‡äº typeofï¼Œæ³¨æ„ï¼Œå°½ç®¡æˆ‘ä»¬ä¼šçœ‹åˆ°è¯¸å¦‚ï¼š

```js
console.log(typeof('hello')); // string
```

çš„å†™æ³•ï¼Œä½†æ˜¯ typeof å¯æ˜¯ä¸€ä¸ªæ­£å®—çš„è¿ç®—ç¬¦ï¼Œå°±è·ŸåŠ å‡ä¹˜é™¤ä¸€æ ·ï¼è¿™å°±èƒ½è§£é‡Šä¸ºä»€ä¹ˆä¸‹é¢è¿™ç§å†™æ³•ä¹Ÿæ˜¯å¯è¡Œçš„ï¼š

```js
console.log(typeof 'hello'); // string
```

å¼•ç”¨ã€ŠJavaScriptæƒå¨æŒ‡å—ã€‹ä¸­å¯¹ typeof çš„ä»‹ç»ï¼š

> typeof æ˜¯ä¸€å…ƒæ“ä½œç¬¦ï¼Œæ”¾åœ¨å…¶å•ä¸ªæ“ä½œæ•°çš„å‰é¢ï¼Œæ“ä½œæ•°å¯ä»¥æ˜¯ä»»æ„ç±»å‹ã€‚è¿”å›å€¼ä¸ºè¡¨ç¤ºæ“ä½œæ•°ç±»å‹çš„ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚

é‚£æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œåœ¨ ES6 å‰ï¼ŒJavaScript å…±å…­ç§æ•°æ®ç±»å‹ï¼Œåˆ†åˆ«æ˜¯ï¼š

`undefined`ã€`object`ã€`boolean`ã€`number`ã€`string`ã€`object`

æ³¨æ„ä»¥ä¸Šéƒ½æ˜¯å°å†™çš„å­—ç¬¦ä¸²ã€‚Null å’Œ Object ç±»å‹éƒ½è¿”å›äº† object å­—ç¬¦ä¸²ã€‚

å°½ç®¡ä¸èƒ½ä¸€ä¸€å¯¹åº”ï¼Œä½†æ˜¯ typeof å´èƒ½æ£€æµ‹å‡ºå‡½æ•°ç±»å‹ï¼š

```js
function a() {};

console.log(typeof a); // function
```

æ‰€ä»¥ typeof èƒ½æ£€æµ‹å‡ºå…­ç§ç±»å‹çš„å€¼ï¼Œä½†æ˜¯ï¼Œé™¤æ­¤ä¹‹å¤– Object ä¸‹è¿˜æœ‰å¾ˆå¤šç»†åˆ†çš„ç±»å‹å‘ï¼Œå¦‚ `Array`ã€`Function`ã€`Date`ã€`RegExp`ã€`Error` ç­‰ã€‚

å¦‚æœç”¨ typeof å»æ£€æµ‹è¿™äº›ç±»å‹ï¼Œä¸¾ä¸ªä¾‹å­ï¼š

```js
var date = new Date();
var error = new Error();
console.log(typeof date); // object
console.log(typeof error); // object
```

è¿”å›çš„éƒ½æ˜¯ object å‘ï¼Œè¿™å¯æ€ä¹ˆåŒºåˆ†~ æ‰€ä»¥æœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹æ³•å‘¢ï¼Ÿ

## äºŒ. Object.prototype.toString

æ˜¯çš„ï¼Œå½“ç„¶æœ‰ï¼è¿™å°±æ˜¯ `Object.prototype.toString`ï¼

é‚£ Object.prototype.toString ç©¶ç«Ÿæ˜¯ä¸€ä¸ªä»€ä¹ˆæ ·çš„æ–¹æ³•å‘¢ï¼Ÿ

ä¸ºäº†æ›´åŠ ç»†è‡´çš„è®²è§£è¿™ä¸ªå‡½æ•°ï¼Œè®©æˆ‘å…ˆçŒ®ä¸Š ES5 è§„èŒƒåœ°å€ï¼š [https://es5.github.io/#x15.2.4.2](https://es5.github.io/#x15.2.4.2) ã€‚

åœ¨ç¬¬ 15.2.4.2 èŠ‚è®²çš„å°±æ˜¯ Object.prototype.toString()ï¼Œä¸ºäº†ä¸è¯¯å¯¼å¤§å®¶ï¼Œæˆ‘å…ˆå¥‰ä¸Šè‹±æ–‡ç‰ˆï¼š

> When the toString method is called, the following steps are taken:

> 1. If the **this** value is **undefined**, return "**[object Undefined]**".
> 2. If the **this** value is **null**, return "**[object Null]**".
> 3. Let O be the result of calling ToObject passing the **this** value as the argument.
> 4. Let class be the value of the [[Class]] internal property of O.
> 5. Return the String value that is the result of concatenating the three Strings "**[object** ", class, and "**]**".

å‡¡æ˜¯è§„èŒƒä¸ŠåŠ ç²—æˆ–è€…æ–œä½“çš„ï¼Œåœ¨è¿™é‡Œæˆ‘ä¹ŸåŠ ç²—æˆ–è€…æ–œä½“äº†ï¼Œå°±æ˜¯è¦è®©å¤§å®¶æ„Ÿå—åŸæ±åŸå‘³çš„è§„èŒƒï¼

å¦‚æœæ²¡æœ‰çœ‹æ‡‚ï¼Œå°±ä¸å¦¨çœ‹çœ‹æˆ‘ç†è§£çš„ï¼š

å½“ toString æ–¹æ³•è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œä¸‹é¢çš„æ­¥éª¤ä¼šè¢«æ‰§è¡Œï¼š

1. å¦‚æœ **this** å€¼æ˜¯ **undefined**ï¼Œå°±è¿”å› **[object Undefined]**
2. å¦‚æœ **this** çš„å€¼æ˜¯ **null**ï¼Œå°±è¿”å› **[object Null]**
3. è®© O æˆä¸º ToObject(**this**) çš„ç»“æœ
4. è®© class æˆä¸º O çš„å†…éƒ¨å±æ€§ [[Class]] çš„å€¼
5. æœ€åè¿”å›ç”± "[object " å’Œ class å’Œ "]" ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆçš„å­—ç¬¦ä¸²

é€šè¿‡è§„èŒƒï¼Œæˆ‘ä»¬è‡³å°‘çŸ¥é“äº†è°ƒç”¨ Object.prototype.toString ä¼šè¿”å›ä¸€ä¸ªç”± "**[object** " å’Œ class å’Œ "**]**" ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œè€Œ class æ˜¯è¦åˆ¤æ–­çš„å¯¹è±¡çš„å†…éƒ¨å±æ€§ã€‚

è®©æˆ‘ä»¬å†™ä¸ª demo:

```js
console.log(Object.prototype.toString.call(undefined)); // [object Undefined]
console.log(Object.prototype.toString.call(null)); // [object Null]

var date = new Date();
console.log(Object.prototype.toString.call(date)); // [object Date]
```

ç”±æ­¤æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ª class å€¼å°±æ˜¯è¯†åˆ«å¯¹è±¡ç±»å‹çš„å…³é”®ï¼

æ­£æ˜¯å› ä¸ºè¿™ç§ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Object.prototype.toString æ–¹æ³•è¯†åˆ«å‡ºæ›´å¤šç±»å‹ï¼

é‚£åˆ°åº•èƒ½è¯†åˆ«å¤šå°‘ç§ç±»å‹å‘¢ï¼Ÿ

è‡³å°‘ 12 ç§ï¼

ä½ å’‹çŸ¥é“çš„ï¼Ÿ

æˆ‘æ•°çš„ï¼

â€¦â€¦

è®©æˆ‘ä»¬çœ‹ä¸ª demo:

```js
// ä»¥ä¸‹æ˜¯11ç§ï¼š
var number = 1;          // [object Number]
var string = '123';      // [object String]
var boolean = true;      // [object Boolean]
var und = undefined;     // [object Undefined]
var nul = null;          // [object Null]
var obj = {a: 1}         // [object Object]
var array = [1, 2, 3];   // [object Array]
var date = new Date();   // [object Date]
var error = new Error(); // [object Error]
var reg = /a/g;          // [object RegExp]
var func = function a(){}; // [object Function]

function checkType() {
  for (var i = 0; i < arguments.length; i++) {
    console.log(Object.prototype.toString.call(arguments[i]))
  }
}

checkType(number, string, boolean, und, nul, obj, array, date, error, reg, func);
```

é™¤äº†ä»¥ä¸Š 11 ç§ä¹‹å¤–ï¼Œè¿˜æœ‰ï¼š

```js
onsole.log(Object.prototype.toString.call(Math)); // [object Math]
console.log(Object.prototype.toString.call(JSON)); // [object JSON]
```

é™¤äº†ä»¥ä¸Š 13 ç§ä¹‹å¤–ï¼Œè¿˜æœ‰ï¼š

```js
function a() {
  console.log(Object.prototype.toString.call(arguments)); // [object Arguments]
}
a();
```

æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¯†åˆ«è‡³å°‘ 14 ç§ç±»å‹ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ç®—å‡ºæ¥ï¼Œ[[class]] å±æ€§è‡³å°‘æœ‰ 12 ä¸ªã€‚

## ä¸‰. type API

æ—¢ç„¶æœ‰äº† Object.prototype.toString è¿™ä¸ªç¥å™¨ï¼é‚£å°±è®©æˆ‘ä»¬å†™ä¸ª type å‡½æ•°å¸®åŠ©æˆ‘ä»¬ä»¥åè¯†åˆ«å„ç§ç±»å‹çš„å€¼å§ï¼

æˆ‘çš„è®¾æƒ³ï¼š

å†™ä¸€ä¸ª type å‡½æ•°èƒ½æ£€æµ‹å„ç§ç±»å‹çš„å€¼ï¼Œå¦‚æœæ˜¯åŸºæœ¬ç±»å‹ï¼Œå°±ä½¿ç”¨ typeofï¼Œå¼•ç”¨ç±»å‹å°±ä½¿ç”¨ toStringã€‚æ­¤å¤–é‰´äº typeof çš„ç»“æœæ˜¯å°å†™ï¼Œæˆ‘ä¹Ÿå¸Œæœ›æ‰€æœ‰çš„ç»“æœéƒ½æ˜¯å°å†™ã€‚

è€ƒè™‘åˆ°å®é™…æƒ…å†µä¸‹å¹¶ä¸ä¼šæ£€æµ‹ Math å’Œ JSONï¼Œæ‰€ä»¥å»æ‰è¿™ä¸¤ä¸ªç±»å‹çš„æ£€æµ‹ã€‚

æˆ‘ä»¬æ¥å†™ä¸€ç‰ˆä»£ç ï¼š

```js
// ç¬¬ä¸€ç‰ˆ
var class2type = {};

// ç”Ÿæˆclass2typeæ˜ å°„
"Boolean Number String Function Array Date RegExp Object Error Null Undefined".split(" ").map(function(item, index) {
  class2type["[object " + item + "]"] = item.toLowerCase();
})

function type(obj) {
  return typeof obj === "object" || typeof obj === "function" ?
      class2type[Object.prototype.toString.call(obj)] || "object" :
      typeof obj;
}
```

å—¯ï¼Œçœ‹èµ·æ¥å¾ˆå®Œç¾çš„æ ·å­~~ ä½†æ˜¯æ³¨æ„ï¼Œåœ¨ IE6 ä¸­ï¼Œnull å’Œ undefined ä¼šè¢« Object.prototype.toString è¯†åˆ«æˆ [object Object]ï¼

æˆ‘å»ï¼Œç«Ÿç„¶è¿˜æœ‰è¿™ä¸ªå…¼å®¹æ€§ï¼æœ‰ä»€ä¹ˆç®€å•çš„æ–¹æ³•å¯ä»¥è§£å†³å—ï¼Ÿé‚£æˆ‘ä»¬å†æ”¹å†™ä¸€ç‰ˆï¼Œç»å¯¹è®©ä½ æƒŠè‰³ï¼

```js
// ç¬¬äºŒç‰ˆ
var class2type = {};

// ç”Ÿæˆclass2typeæ˜ å°„
"Boolean Number String Function Array Date RegExp Object Error".split(" ").map(function(item, index) {
  class2type["[object " + item + "]"] = item.toLowerCase();
})

function type(obj) {
  // ä¸€ç®­åŒé›•
  if (obj == null) {
    return obj + "";
  }
  return typeof obj === "object" || typeof obj === "function" ?
      class2type[Object.prototype.toString.call(obj)] || "object" :
      typeof obj;
}
```

## å››. isFunction

æœ‰äº† type å‡½æ•°åï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å¸¸ç”¨çš„åˆ¤æ–­ç›´æ¥å°è£…ï¼Œæ¯”å¦‚ isFunction:

```js
function isFunction(obj) {
  return type(obj) === "function";
}
```

## äº”. æ•°ç»„

jQuery åˆ¤æ–­æ•°ç»„ç±»å‹ï¼Œæ—§ç‰ˆæœ¬æ˜¯é€šè¿‡åˆ¤æ–­ Array.isArray æ–¹æ³•æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨å°±ä½¿ç”¨è¯¥æ–¹æ³•ï¼Œä¸å­˜åœ¨å°±ä½¿ç”¨ type å‡½æ•°ã€‚

```js
var isArray = Array.isArray || function( obj ) {
  return type(obj) === "array";
}
```

ä½†æ˜¯åœ¨ jQuery v3.0 ä¸­å·²ç»å®Œå…¨é‡‡ç”¨äº† Array.isArrayã€‚

## ğŸŒŸ. ç»“è¯­

åˆ°æ­¤ï¼Œç±»å‹åˆ¤æ–­çš„ä¸Šç¯‡å°±ç»“æŸäº†ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥åˆ¤æ–­æ—¥æœŸã€æ­£åˆ™ã€é”™è¯¯ç±»å‹å•¦ï¼Œä½†æ˜¯è¿˜æœ‰æ›´å¤æ‚çš„åˆ¤æ–­æ¯”å¦‚ plainObjectã€ç©ºå¯¹è±¡ã€Windowå¯¹è±¡ã€ç±»æ•°ç»„å¯¹è±¡ç­‰ï¼Œè·¯æ¼«æ¼«å…¶ä¿®è¿œå…®ï¼Œå¾å°†ä¸Šä¸‹è€Œæ±‚ç´¢ã€‚

å“¦ï¼Œ å¯¹äº†ï¼Œè¿™ä¸ª type å‡½æ•°æŠ„çš„ jQueryï¼Œ [ç‚¹å‡»æŸ¥çœ‹ type æºç ](https://github.com/jquery/jquery/blob/ac9e3016645078e1e42120822cfb2076151c8cbe/src/core.js#L269) ã€‚
