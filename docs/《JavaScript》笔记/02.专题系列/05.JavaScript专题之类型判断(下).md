---
title: JavaScript ä¸“é¢˜ä¹‹ç±»åž‹åˆ¤æ–­(ä¸‹)
date: 2021-10-22 21:54:25
permalink: /pages/6937ce/
categories:
  - å‰ç«¯æŠ€æœ¯
tags:
  - Webå¼€å‘
  - JavaScript
  - ä¸“é¢˜ç³»åˆ—
author:
  name: Jamison
  link: https://github.com/oliver556
---

# JavaScript ä¸“é¢˜ä¹‹ç±»åž‹åˆ¤æ–­(ä¸‹)

## ðŸ“–. å‰è¨€

åœ¨ä¸Šç¯‡[ã€ŠJavaScript ä¸“é¢˜ä¹‹ç±»åž‹åˆ¤æ–­(ä¸Š)ã€‹](04.JavaScriptä¸“é¢˜ä¹‹ç±»åž‹åˆ¤æ–­%28ä¸Š%29.md) ä¸­ï¼Œæˆ‘ä»¬æŠ„è¢­ jQuery å†™äº†ä¸€ä¸ª type å‡½æ•°ï¼Œå¯ä»¥æ£€æµ‹å‡ºå¸¸è§çš„æ•°æ®ç±»åž‹ï¼Œç„¶è€Œåœ¨å¼€å‘ä¸­è¿˜æœ‰æ›´åŠ å¤æ‚çš„åˆ¤æ–­ï¼Œ
æ¯”å¦‚ plainObjectã€ç©ºå¯¹è±¡ã€Window å¯¹è±¡ç­‰ï¼Œè¿™ä¸€ç¯‡å°±è®©æˆ‘ä»¬æŽ¥ç€æŠ„è¢­ jQuery åŽ»çœ‹ä¸€ä¸‹è¿™äº›ç±»åž‹çš„åˆ¤æ–­ã€‚

## ä¸€. plainObject

plainObject æ¥è‡ªäºŽ jQueryï¼Œå¯ä»¥ç¿»è¯‘æˆçº¯ç²¹çš„å¯¹è±¡ï¼Œæ‰€è°“"çº¯ç²¹çš„å¯¹è±¡"ï¼Œå°±æ˜¯è¯¥å¯¹è±¡æ˜¯é€šè¿‡ "{}" æˆ– "new Object" åˆ›å»ºçš„ï¼Œè¯¥å¯¹è±¡å«æœ‰é›¶ä¸ªæˆ–è€…å¤šä¸ªé”®å€¼å¯¹ã€‚

ä¹‹æ‰€ä»¥è¦åˆ¤æ–­æ˜¯ä¸æ˜¯ plainObjectï¼Œæ˜¯ä¸ºäº†è·Ÿå…¶ä»–çš„ JavaScriptå¯¹è±¡å¦‚ nullï¼Œæ•°ç»„ï¼Œå®¿ä¸»å¯¹è±¡ï¼ˆdocumentsï¼‰ç­‰ä½œåŒºåˆ†ï¼Œå› ä¸ºè¿™äº›ç”¨ typeof éƒ½ä¼šè¿”å›žobjectã€‚

jQueryæä¾›äº† isPlainObject æ–¹æ³•è¿›è¡Œåˆ¤æ–­ï¼Œå…ˆè®©æˆ‘ä»¬çœ‹çœ‹ä½¿ç”¨çš„æ•ˆæžœï¼š

```js
function Person(name) {
  this.name = name;
}

console.log($.isPlainObject({})) // true

console.log($.isPlainObject(new Object)) // true

console.log($.isPlainObject(Object.create(null))); // true

console.log($.isPlainObject(Object.assign({a: 1}, {b: 2}))); // true

console.log($.isPlainObject(new Person('yayu'))); // false

console.log($.isPlainObject(Object.create({}))); // false
```

ç”±æ­¤æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œé™¤äº† {} å’Œ new Object åˆ›å»ºçš„ä¹‹å¤–ï¼ŒjQuery è®¤ä¸ºä¸€ä¸ªæ²¡æœ‰åŽŸåž‹çš„å¯¹è±¡ä¹Ÿæ˜¯ä¸€ä¸ªçº¯ç²¹çš„å¯¹è±¡ã€‚

å®žé™…ä¸Šéšç€ jQuery ç‰ˆæœ¬çš„æå‡ï¼ŒisPlainObject çš„å®žçŽ°ä¹Ÿåœ¨å˜åŒ–ï¼Œæˆ‘ä»¬ä»Šå¤©è®²çš„æ˜¯ 3.0 ç‰ˆæœ¬ä¸‹çš„ isPlainObjectï¼Œæˆ‘ä»¬ç›´æŽ¥çœ‹æºç ï¼š

```js
// ä¸ŠèŠ‚ä¸­å†™ type å‡½æ•°æ—¶ï¼Œç”¨æ¥å­˜æ”¾ toString æ˜ å°„ç»“æžœçš„å¯¹è±¡
var class2type = {};

// ç›¸å½“äºŽ Object.prototype.toString
var toString = class2type.toString;

// ç›¸å½“äºŽ Object.prototype.hasOwnProperty
var hasOwn = class2type.hasOwnProperty;

function isPlainObject(obj) {
  var proto, Ctor;
  
  // æŽ’é™¤æŽ‰æ˜Žæ˜¾ä¸æ˜¯objçš„ä»¥åŠä¸€äº›å®¿ä¸»å¯¹è±¡å¦‚Window
  if (!obj || toString.call(obj) !== "[object Object]") {
    return false;
  }
  
  /**
  * getPrototypeOf es5 æ–¹æ³•ï¼ŒèŽ·å– obj çš„åŽŸåž‹
  * ä»¥ new Object åˆ›å»ºçš„å¯¹è±¡ä¸ºä¾‹çš„è¯
  * obj.__proto__ === Object.prototype
  */
  proto = Object.getPrototypeOf(obj);
  
  // æ²¡æœ‰åŽŸåž‹çš„å¯¹è±¡æ˜¯çº¯ç²¹çš„ï¼ŒObject.create(null) å°±åœ¨è¿™é‡Œè¿”å›ž true
  if (!proto) {
    return true;
  }
  
  /**
  * ä»¥ä¸‹åˆ¤æ–­é€šè¿‡ new Object æ–¹å¼åˆ›å»ºçš„å¯¹è±¡
  * åˆ¤æ–­ proto æ˜¯å¦æœ‰ constructor å±žæ€§ï¼Œå¦‚æžœæœ‰å°±è®© Ctor çš„å€¼ä¸º proto.constructor
  * å¦‚æžœæ˜¯ Object å‡½æ•°åˆ›å»ºçš„å¯¹è±¡ï¼ŒCtor åœ¨è¿™é‡Œå°±ç­‰äºŽ Object æž„é€ å‡½æ•°
  */
  Ctor = hasOwn.call(proto, "constructor") && proto.constructor;
  
  // åœ¨è¿™é‡Œåˆ¤æ–­ Ctor æž„é€ å‡½æ•°æ˜¯ä¸æ˜¯ Object æž„é€ å‡½æ•°ï¼Œç”¨äºŽåŒºåˆ†è‡ªå®šä¹‰æž„é€ å‡½æ•°å’Œ Object æž„é€ å‡½æ•°
  return typeof Ctor === "function" && hasOwn.toString.call(Ctor) === hasOwn.toString.call(Object);
}
```

âš ï¸ æ³¨æ„ï¼šæˆ‘ä»¬åˆ¤æ–­ Ctor æž„é€ å‡½æ•°æ˜¯ä¸æ˜¯ Object æž„é€ å‡½æ•°ï¼Œç”¨çš„æ˜¯ hasOwn.toString.call(Ctor)ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä¸æ˜¯ Object.prototype.toStringï¼Œä¸ä¿¡æˆ‘ä»¬åœ¨å‡½æ•°é‡ŒåŠ ä¸Šä¸‹é¢è¿™ä¸¤å¥è¯ï¼š

```js
console.log(hasOwn.toString.call(Ctor)); // function Object() { [native code] }
console.log(Object.prototype.toString.call(Ctor)); // [object Function]
```

å‘çŽ°è¿”å›žçš„å€¼å¹¶ä¸ä¸€æ ·ï¼Œè¿™æ˜¯å› ä¸º hasOwn.toString è°ƒç”¨çš„å…¶å®žæ˜¯ Function.prototype.toStringï¼Œæ¯•ç«Ÿ hasOwnProperty å¯æ˜¯ä¸€ä¸ªå‡½æ•°ï¼

è€Œä¸” Function å¯¹è±¡è¦†ç›–äº†ä»Ž Object ç»§æ‰¿æ¥çš„ Object.prototype.toString æ–¹æ³•ã€‚å‡½æ•°çš„ toString æ–¹æ³•ä¼šè¿”å›žä¸€ä¸ªè¡¨ç¤ºå‡½æ•°æºä»£ç çš„å­—ç¬¦ä¸²ã€‚å…·ä½“æ¥è¯´ï¼ŒåŒ…æ‹¬ functionå…³é”®å­—ï¼Œå½¢å‚åˆ—è¡¨ï¼Œå¤§æ‹¬å·ï¼Œä»¥åŠå‡½æ•°ä½“ä¸­çš„å†…å®¹ã€‚

## äºŒ. EmptyObject

jQuery æä¾›äº† isEmptyObject æ–¹æ³•æ¥åˆ¤æ–­æ˜¯å¦æ˜¯ç©ºå¯¹è±¡ï¼Œä»£ç ç®€å•ï¼Œæˆ‘ä»¬ç›´æŽ¥çœ‹æºç ï¼š

```jsfunction isEmptyObject( obj ) {

  var name;
  
  for ( name in obj ) {
    return false;
  }
  
return true;
}
```

å…¶å®žæ‰€è°“çš„ isEmptyObject å°±æ˜¯åˆ¤æ–­æ˜¯å¦æœ‰å±žæ€§ï¼Œfor å¾ªçŽ¯ä¸€æ—¦æ‰§è¡Œï¼Œå°±è¯´æ˜Žæœ‰å±žæ€§ï¼Œæœ‰å±žæ€§å°±ä¼šè¿”å›ž falseã€‚

ä½†æ˜¯æ ¹æ®è¿™ä¸ªæºç æˆ‘ä»¬å¯ä»¥çœ‹å‡ºisEmptyObjectå®žé™…ä¸Šåˆ¤æ–­çš„å¹¶ä¸ä»…ä»…æ˜¯ç©ºå¯¹è±¡ã€‚

ä¸¾ä¸ªæ —å­ï¼š

```js
console.log(isEmptyObject({})); // true
console.log(isEmptyObject([])); // true
console.log(isEmptyObject(null)); // true
console.log(isEmptyObject(undefined)); // true
console.log(isEmptyObject(1)); // true
console.log(isEmptyObject('')); // true
console.log(isEmptyObject(true)); // true
```

ä»¥ä¸Šéƒ½ä¼šè¿”å›ž trueã€‚

ä½†æ˜¯æ—¢ç„¶ jQuery æ˜¯è¿™æ ·å†™ï¼Œå¯èƒ½æ˜¯å› ä¸ºè€ƒè™‘åˆ°å®žé™…å¼€å‘ä¸­ isEmptyObject ç”¨æ¥åˆ¤æ–­ {} å’Œ {a: 1} æ˜¯è¶³å¤Ÿçš„å§ã€‚å¦‚æžœçœŸçš„æ˜¯åªåˆ¤æ–­ {}ï¼Œå®Œå…¨å¯ä»¥ç»“åˆä¸Šç¯‡å†™çš„ type å‡½æ•°ç­›é€‰æŽ‰ä¸é€‚åˆçš„æƒ…å†µã€‚

## ä¸‰. Window å¯¹è±¡

Window å¯¹è±¡ä½œä¸ºå®¢æˆ·ç«¯ JavaScript çš„å…¨å±€å¯¹è±¡ï¼Œå®ƒæœ‰ä¸€ä¸ª window å±žæ€§æŒ‡å‘è‡ªèº«ï¼Œè¿™ç‚¹åœ¨ [ã€ŠJavaScriptæ·±å…¥ä¹‹å˜é‡å¯¹è±¡ã€‹](../01.æ·±å…¥ç³»åˆ—/04.JavaScriptæ·±å…¥ä¹‹å˜é‡å¯¹è±¡.md) ä¸­è®²åˆ°è¿‡ã€‚
æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§åˆ¤æ–­æ˜¯å¦æ˜¯ Window å¯¹è±¡ã€‚

```js
function isWindow( obj ) {
  return obj != null && obj === obj.window;
}
```

## å››. isArrayLike

isArrayLikeï¼Œçœ‹åå­—å¯èƒ½ä¼šè®©æˆ‘ä»¬è§‰å¾—è¿™æ˜¯åˆ¤æ–­ç±»æ•°ç»„å¯¹è±¡çš„ï¼Œå…¶å®žä¸ä»…ä»…æ˜¯è¿™æ ·ï¼ŒjQuery å®žçŽ°çš„ isArrayLikeï¼Œæ•°ç»„å’Œç±»æ•°ç»„éƒ½ä¼šè¿”å›ž trueã€‚

å› ä¸ºæºç æ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬ç›´æŽ¥çœ‹æºç ï¼š

```js
function isArrayLike(obj) {

  // obj å¿…é¡»æœ‰ lengthå±žæ€§
  var length = !!obj && "length" in obj && obj.length;
  var typeRes = type(obj);
  
  // æŽ’é™¤æŽ‰å‡½æ•°å’Œ Window å¯¹è±¡
  if (typeRes === "function" || isWindow(obj)) {
    return false;
  }
  
  return typeRes === "array" || length === 0 ||
      typeof length === "number" && length > 0 && (length - 1) in obj;
}
```

é‡ç‚¹åˆ†æž return è¿™ä¸€è¡Œï¼Œä½¿ç”¨äº†æˆ–è¯­å¥ï¼Œåªè¦ä¸€ä¸ªä¸º trueï¼Œç»“æžœå°±è¿”å›ž trueã€‚

æ‰€ä»¥å¦‚æžœ isArrayLike è¿”å›žtrueï¼Œè‡³å°‘è¦æ»¡è¶³ä¸‰ä¸ªæ¡ä»¶ä¹‹ä¸€ï¼š

1. æ˜¯æ•°ç»„
2. é•¿åº¦ä¸º 0
3. lengths å±žæ€§æ˜¯å¤§äºŽ 0 çš„æ•°å­—ç±»åž‹ï¼Œå¹¶ä¸”obj[length - 1]å¿…é¡»å­˜åœ¨

ç¬¬ä¸€ä¸ªå°±ä¸è¯´äº†ï¼Œçœ‹ç¬¬äºŒä¸ªï¼Œä¸ºä»€ä¹ˆé•¿åº¦ä¸º 0 å°±å¯ä»¥ç›´æŽ¥åˆ¤æ–­ä¸º true å‘¢ï¼Ÿ

é‚£æˆ‘ä»¬å†™ä¸ªå¯¹è±¡ï¼š

```js
var obj = {a: 1, b: 2, length: 0};
```

isArrayLike å‡½æ•°å°±ä¼šè¿”å›ž trueï¼Œé‚£è¿™ä¸ªåˆç†å—ï¼Ÿ

å›žç­”åˆä¸åˆç†ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªä¾‹å­ï¼š

```js
function a(){
  console.log(isArrayLike(arguments));
}
a();
```

å¦‚æžœæˆ‘ä»¬åŽ»æŽ‰length === 0 è¿™ä¸ªåˆ¤æ–­ï¼Œå°±ä¼šæ‰“å° falseï¼Œç„¶è€Œæˆ‘ä»¬éƒ½çŸ¥é“ arguments æ˜¯ä¸€ä¸ªç±»æ•°ç»„å¯¹è±¡ï¼Œè¿™é‡Œæ˜¯åº”è¯¥è¿”å›ž true çš„ã€‚

æ‰€ä»¥æ˜¯ä¸æ˜¯ä¸ºäº†æ”¾è¿‡ç©ºçš„ arguments æ—¶ä¹Ÿæ”¾è¿‡äº†ä¸€äº›å­˜åœ¨äº‰è®®çš„å¯¹è±¡å‘¢ï¼Ÿ

ç¬¬ä¸‰ä¸ªæ¡ä»¶ï¼šlength æ˜¯æ•°å­—ï¼Œå¹¶ä¸” length > 0 ä¸”æœ€åŽä¸€ä¸ªå…ƒç´ å­˜åœ¨ã€‚

ä¸ºä»€ä¹ˆä»…ä»…è¦æ±‚æœ€åŽä¸€ä¸ªå…ƒç´ å­˜åœ¨å‘¢ï¼Ÿ

è®©æˆ‘ä»¬å…ˆæƒ³ä¸‹æ•°ç»„æ˜¯ä¸æ˜¯å¯ä»¥è¿™æ ·å†™ï¼š

```js
var arr = [,,3];
```

å½“æˆ‘ä»¬å†™ä¸€ä¸ªå¯¹åº”çš„ç±»æ•°ç»„å¯¹è±¡å°±æ˜¯ï¼š

```js
var arrLike = {
  2: 3,
  length: 3
}
```

ä¹Ÿå°±æ˜¯è¯´å½“æˆ‘ä»¬åœ¨æ•°ç»„ä¸­ç”¨é€—å·ç›´æŽ¥è·³è¿‡çš„æ—¶å€™ï¼Œæˆ‘ä»¬è®¤ä¸ºè¯¥å…ƒç´ æ˜¯ä¸å­˜åœ¨çš„ï¼Œç±»æ•°ç»„å¯¹è±¡ä¸­ä¹Ÿå°±ä¸ç”¨å†™è¿™ä¸ªå…ƒç´ ï¼Œä½†æ˜¯æœ€åŽä¸€ä¸ªå…ƒç´ æ˜¯ä¸€å®šè¦å†™çš„ï¼Œè¦ä¸ç„¶ length çš„é•¿åº¦å°±ä¸ä¼šæ˜¯æœ€åŽä¸€ä¸ªå…ƒç´ çš„ key å€¼åŠ  1ã€‚æ¯”å¦‚æ•°ç»„å¯ä»¥è¿™æ ·å†™

```js
var arr = [1,,];
console.log(arr.length); // 2
```

ä½†æ˜¯ç±»æ•°ç»„å¯¹è±¡å°±åªèƒ½å†™æˆï¼š

```js
var arrLike = {
  0: 1,
  length: 1
}
```

æ‰€ä»¥ç¬¦åˆæ¡ä»¶çš„ç±»æ•°ç»„å¯¹è±¡æ˜¯ä¸€å®šå­˜åœ¨æœ€åŽä¸€ä¸ªå…ƒç´ çš„ï¼

è¿™å°±æ˜¯æ»¡è¶³ isArrayLike çš„ä¸‰ä¸ªæ¡ä»¶ï¼Œå…¶å®žé™¤äº† jQuery ä¹‹å¤–ï¼Œå¾ˆå¤šåº“éƒ½æœ‰å¯¹ isArrayLike çš„å®žçŽ°ï¼Œæ¯”å¦‚ underscore:

```js
var MAX_ARRAY_INDEX = Math.pow(2, 53) - 1;

var isArrayLike = function(collection) {
  var length = getLength(collection);
  return typeof length == 'number' && length >= 0 && length <= MAX_ARRAY_INDEX;
};
```

## äº”. isElement

isElement åˆ¤æ–­æ˜¯ä¸æ˜¯ DOM å…ƒç´ ã€‚

```js
isElement = function(obj) {
  return !!(obj && obj.nodeType === 1);
};
```

## ðŸŒŸ. ç»“è¯­

è¿™ä¸€ç¯‡æˆ‘ä»¬ä»‹ç»äº† jQuery çš„ isPlainObjectã€isEmptyObjectã€isWindowã€isArrayLikeã€ä»¥åŠ underscore çš„ isElement å®žçŽ°ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå³ä½¿æ˜¯ jQuery è¿™æ ·ä¼˜ç§€çš„åº“ï¼Œä¸€äº›æ–¹æ³•çš„å®žçŽ°ä¹Ÿå¹¶ä¸æ˜¯éžå¸¸å®Œç¾Žå’Œä¸¥å¯†çš„ï¼Œ
ä½†æ˜¯æœ€åŽä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼Œå…¶å®žä¹Ÿæ˜¯ä¸€ç§æƒè¡¡ï¼Œæƒè¡¡æ‰€å¤±ä¸Žæ‰€å¾—ï¼Œæ­£å¦‚çŽ‰ä¼¯åœ¨ã€Šä»Ž JavaScript æ•°ç»„åŽ»é‡è°ˆæ€§èƒ½ä¼˜åŒ–ã€‹ä¸­è®²åˆ°ï¼š

**æ‰€æœ‰è¿™äº›ç‚¹ï¼Œéƒ½å¿…é¡»è„šè¸å®žåœ°åœ¨å…·ä½“åº”ç”¨åœºæ™¯ä¸‹åŽ»åˆ†æžã€åŽ»é€‰æ‹©ï¼Œè¦è®©åœºæ™¯è¯´è¯ã€‚**
